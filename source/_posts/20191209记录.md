---
title: 20191209记录
date: 2019-12-09 14:36:36
tags:
- 记录
---



# 1209

## 特效检查工具

- 检查D

  - 加长播放时间（已修改）

    导致D值变大

  - 设置摄像机位置（正在加，预计今晚做完）

    根据特效的实时包围盒大小获取最大**包围盒**，设置**摄像机**位置，再进行检查

    【问题：有个别特效在e=16时，没有结束，eg：low_kog_hcy_zy_mofang_ruqin_mov_01、low_pfx_mon_xueshou_002_skill03

    已解决：timer被释放，加到_G的表中解决】

  - 测试

    给飞哥新的数据，调整特效的标准

- 检查P

  - 分类

    去mesh去decalP；meshP；decalP

  - 测试

    给飞哥用来定标准，并调整去mesh去decalP的标准

  - 给WP同步增加的检查信息

  

## 角色检查工具

分文件夹检查

res目录下

| 一级文件夹 | 二级文件夹         | 三级文件夹   | 文件名           | 分类                |
| ---------- | ------------------ | ------------ | ---------------- | ------------------- |
| cha        | 主角自己（文件夹） | 高（文件夹） | 头发（文件命名） | 主角-自己-高级-头发 |
|            |                    |              | 脸（文件命名）   |                     |
|            |                    |              | 武器（其他）     |                     |
|            |                    | 中           | （武器）         |                     |
|            |                    | 低           | （武器）         |                     |
|            | 主角其他           | ……           |                  |                     |
| mon        |                    |              |                  |                     |
| ……         |                    |              |                  |                     |

已修改

# 1210

## 特效检查工具

修改问题：

- 检查mesh的P或者decal的P，将disable换成dummy
- 



开发环境



- wp本地（url = "http://10.1.111.103:8602//api/wp/pub/callbackSpecialEffects"）

- 132（虚拟机）

测试环境

- 177（url = "http://10.1.1.177:80/api/wp/pub/callbackSpecialEffects"）
- 47（本机）

正式环境

- 178（url = "http://10.1.1.178:80/api/wp/pub/callbackSpecialEffects）
- 131



注意：

1. 不同环境的url不一样（将URL移动到job中设置）
2. 有渲染窗口，所以需要确认` -tool -attach`是否可以；取消用-d
3. 加一个参数（用来判断是否要实际检查特效）
4. 对于正式环境使用的模块，在job中固定版本号（每次迭代固定到最稳定的版本）



调整成30帧检查

注意：

1. 调整e为33
2. 更新资源到最新



明天早上

1. 给kog新的检查结果
2. 解决打包特效的bug
3. 解决检查工具检查单元测试问题

# 1211

- [ ] 修改标准，出新数据
- [ ] 

## 检查打包工具自定义特效bug

对于Android9的版本，eclipse没能识别，

需要加Android28（\\10.1.16.15\share\Software\Android\android-28.7z）到E:\Android\sdk-eclipse\platforms

加完之后，java版本需要更新成特定的1.8的版本（\\10.1.16.15\share\Software\Android\jdk-8u211-windows-i586.exe）【1023记录环境变量配置】

## 检查特效工具

编辑器显示D值不正确

## WP特效审计

1. 假数据（增加明细）
2. 把环境特效等先取消
3. 已更新标准（检查的参数）
4. 和飞哥对特效贴图的信息
5. 明天和WP联调



# 1212

给飞哥新数据

之后修改贴图的统计

需要验证打包问题是否解决



## 打包特效不正确的问题

1. save方法只有fs引擎有
2. 处理特效时，特效依赖的部分图片已经被压缩，加载资源失败`Load resource data failed`



## 给飞哥的数据：

1. 增加每一项检查的数量
2. 贴图尺寸调整



## 给WP的信息

1. message的格式已调整

   高端机和低端机的信息格式

   总的信息格式

   贴图的信息格式

2. detail信息加到发送的数据中了，每一项检查中加了详细信息的索引

   增加detail数组

   - 详细信息的数组
   - 每个检查项中详细信息的索引

3. 每项检查中加上了count字段

   每个检查项中增加包含的检查对象数量

# 1213

和WP进行联调

- 增加POSTURL端口字段
- 添加遗漏的贴图count信息
- 贴图尺寸使用128*128这样的格式

问题记录：

- 注意post的地址和端口写正确

- 对于WP开发人员本地的网段，使用1网段的机器测试，本地16网段与1网段不通



贴图信息的完善

- 文件夹检查贴图

  区分128以下2的幂的图片

  256贴图

  512贴图

  其他非常规贴图或大尺寸贴图

- pfx单个文件检查贴图

  看老工具给的信息是什么，继续检查相同信息

- 和WP沟通显示方式



加单元测试

- 测试单个特效拿到的数据正确



**对于近期特效检查工具的总结**

1. 单元测试

2. 代码结构

   命名
   子进程长
   拆分模块

3. 功能

   meshP标准

   详细信息中增加贴图信息

   两个字段确定资源

# 1214

调整安排：

- 和WP一起调整，将工具部署到正式环境

- 给飞哥的表格暂时不给，推动使用WP使用
- 部署和推动WP使用过程中进行代码重构

- 在正式使用之前将新功能加进去

- base-job，开发、测试、生产环境三个job调用这个job

其他：

- 提WT，修改D值统计逻辑，修复编辑器显示D值偏少的问题

【FS】【特效】右下角D值显示不正确

特效编辑器中右下角D值统计不全

例子：

svn例子中特效：xxx 实际D值为4，编辑器中显示为0

有时候能统计到……

## 自动化测试

去掉验证和签名的patch，去掉

在引擎中加宏控制

## 整理job

主参数：

- 项目名称（默认kog）

- 资源svn地址（默认kog主干）

- 资源版本号（默认head）

- 资源本地地址

- 模块的svn地址（暂时默认当前开发分支）

- 模块的版本号（默认head）

- 模块本地co地址

- 执行的结点（默认测试环境）

- post地址

- wpid

- 是否使用中间数据（应该去掉job参数）

  当前开发环境不能连通；

  测试环境使用小例子（提交测试资源到svn）（确认测试环境不锁屏，能够测试资源）

  正式环境是否使用现成的假数据（暂时在主job中控制）

- 



待办：

command中的配置区分项目，job增加项目名称参数

完善对传递参数的判断和出错报告（之后有问题再加错误上报）

使用的引擎需要自动化测试使用的（暂时提交到分支一版引擎，未定后续方案）



主进程的node由上层的node指定（修改设置node的位置）



功能上要和打包的资源保持一致

1. 执行的链接中需要加指定资源版本的svn地址、svn版本
2. 和打包资源使用同一个svn地址



添加时间统计

加速检查时间