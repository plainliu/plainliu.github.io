---
title: 20190729记录
date: 2019-08-16 13:21:54
tags:
---

# 0729

## 测试模块描述

**Test_Auto_Record**

- 功能：录制操作步骤，操作结束后点击右上角关闭自动保存录制结果

- 输入：要录制的lua脚本，操作步骤保存路径（以及是否将lua脚本路径设置为工作路径）

- 输出：操作步骤文件

**Test_Auto_Capture**

- 功能：根据操作步骤（由Test_Auto_Record录制而来），自动截图测试lua脚本；

  如果没有操作步骤，使用过程中设置Test_Auto_Capture的截图属性来截图，需要调用结束测试的接口来结束测试

- 输入：测试资源工作路径，截图目标路径，lua脚本，操作步骤文件

- 输出：截图和log/error信息，输出目标地址由输入的截图目标路径指定

**Test_Auto_Sample_Compare**

- 功能：两版引擎（调用复制引擎的接口，将引擎复制到指定目录下），自动测试指定文件夹下所有能够找到对应操作步骤的lua脚本（操作步骤使用Test_Auto_Record录制而来，测试过程中在operations文件夹下脚本同目录中找操作步骤）

- 输入：两版引擎的源地址和目标地址，测试文件夹，忽略的文件

- 输出：生成两版引擎各自测试脚本的结果信息，保存在测试引擎目录下，脚本测试结果保存在脚本相对路径同名的目录中

**Test_ResourceManager**

- 功能：测试资源类，设置资源的摄像机位置和draw方法

- 输入：资源名称

- 输出：资源管理类，可以通过该类的实例化对象，增加测试需要的摄像机位置和渲染方法

**Test_Auto_Resource_Compare**

- 功能：两版引擎（调用复制引擎的接口，将引擎复制到指定目录下），自动测试指定路径下所有pfx，sen和msh类型的资源（或部分列出的资源）

- 输入：资源路径（测试部分资源需要列出部分资源的名称）

- 输出：生成两版引擎各自的截图信息，结果保存在被测引擎的目录下资源路径名对应的文件夹中，对于每个被测试的资源，测试结果所在的文件夹名称为资源后缀名加资源名称

**Test_Auto_Module**

- 功能：自动测试模块（测试所有模块，单个模块），对比已有截图信息（模块test\autocapture存储的信息），生成测试报告

- 输入：测试单个模块则输入为被测试模块名

- 输出：测试报告（测试模块通过比，每个模块测试具体文件通过数目）

**Test_Auto_CompareFolder**

- 功能：对比两个文件夹中的内容，得到对比结果

- 输入：两个文件夹的地址

- 输出：测试通过的文件数，文件总数，及对比出现不同的文件的信息



修改测试描述，功能设计的东西

纯功能设计上的



测试

单元测试

有了这个，以后修改代码，就不是谨慎地修改，祈祷不出错误

# 0730

## 色图工具

总体：

1. 拿到像素
2. 像素转HSV，统计
3. 统计画图

### 画饼图

**接口：**

（需要先将表 item{name(, value), count} 转换为 item{name, count, color} 的形式（color从value计算得到），用来指定扇形颜色）

- drawPieChart(x, y, r, {tb}, showdetail)

  输入：位置，大小，表（item{name, count, color}），是否显示name（value值的范围?），百分比

  实现：

  - 计算表中每一项的比例 xx%（item{name, xx%, color}）

  - 根据比例得到扇形角度（画三角形，填充颜色）

  - 文字显示在图片旁（颜色和name/比例，对应列出），如下图形式

    ![1564465007911](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\1564465007911.png)

  输出：饼图

**问题：**

- 输入的表项关键字是value，画图以value作为关键字统计？统计的过程在画图的上一层，还是在画饼图的功能中处理
- 关键字范围，对应一个扇形（关键字的范围怎么定，固定分段统计？）
- 饼图属于总模块的功能，或是总模块调用到的功能
- 从数据到分段区间，区间到饼图的过程
- 区间怎么显示

### 饼图模块

**PieChart类**

**属性**

- x：number，饼图中心位置横坐标
- y：number，饼图中心位置纵坐标
- r：number，饼图半径
- showname：bool，是否显示名称
- drawinfo：table，每一项对应一个扇形数据，{名字，比例，颜色}（不对外的属性，渲染使用）

**构造**

- new(x, y, r, data[, showname])：构造方法
  - 调用setData(data) 设置 drawinfo
  - showname 默认为false

**方法**

- draw()：渲染（画三角形，填充颜色）

- setData(data：table)：设置饼图数据，重新计算比例，更新drawinfo
  - data项：{名字，权重，颜色}

**修改**

1. x和y记为positon，二维的点
2. drawinfo改为sectorinfo
3. bug：防止精确度影响，导致画最后一个三角形时ratio不足1

# 0731

## 色图工具

### 绘制色相和颜色对应

色相条（位置，大小）

给定几个颜色

找位置

画关系



**HueMatching类**

**属性**

- x : number 色相条左上角横坐标
- y : number 色相条左上角纵坐标
- w : number 色相条宽度
- h : number 色相条高度
- colors : table 在色相条上找的颜色（通过方法控制，该属性不对外），表中的项为有h属性的_Color对象

**构造**

- new(x, y, w, h[, colors])：构造方法

**方法**

- addMatchColor(color : uint/_Color) 添加在色相图中匹配的颜色（根据h值排序）
- setMatchColors(colors : table) 设置要在色相图中寻找的颜色，colors的项为_Color类型或uint类型
- draw() 渲染
  - 画色相条
  - 画要匹配的颜色和颜色值
  - 标记匹配关系（由h找到对应位置，连线/标记色相条上的位置）

**内部使用的方法**

- convertHSVtoRGB(h, s, v) : uint画色相条用
- ~~getH(r, g, b) 对要找的颜色排序，及匹配色相条位置时使用~~
- addHueToColor(color : _Color)



### 中位切分法

# 0801

## 色图

**主流程**

扇形图需要的数据表{name, value, color}

SV区间 需要的表 {name}

H分析



问题：

拿真实图片测试吗？算法的输入是



**经验教训：**

每个人先写好对外的接口和参数属性的数据类型

先沟通接口的合理性，再完成整个过程

## 安排

1. 色图工具
2. 编辑器加描边开关
3. 加模拟操作回调
4. 修改模块化细节面板代码
5. 天空水面盒属性不能修改的问题

# 0802

单元测试，运行的结果与预想的结果做对比

首先明确想要的是什么样的结果

输入和输出的数据是什么样的，类型和范围等

其次，尽可能覆盖所有情况



# 0803

色图工具第一版

修改算法

# 0804

细节面板相关

![1564883589515](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\1564883589515.png)

![1564882274586](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\1564882274586.png)

---

问题：

1. 小数点后保留的位数/input回车后起效

   ![1564883382938](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\1564883382938.png)

2. 几个setting，定义类的位置，是否定义为全局的

3. 拆RDsetting方案与计划

4. 











## 录制和模拟运行的接口

分享：

记录文档的语言或工具，方便更新文档

当前pdf的不足之处：

- 修改不方便，如果之后其他人修改了这个模块，修改文档则需要重新写一遍再导出为pdf

## 学习安排

minux

3d渲染

图形学

游戏

Latex

UE代码